Commit Notes
------------
Rename Sample => SampleOp everywhere on server side excepting dto package.
Rename SampleRefreshError => SampleOpRefreshNotice.

LabsDSSampleOpRefreshService
  @Transactional methods are not starting transactions because they are being called internally.
  Separate the methods into a helper "ops" class.

Sample Refresh Error
--------------------
Why are updates of the fake data failing?
2018-10-01 15:26:00.055  INFO 11216 --- [ask-scheduler-1] g.f.n.a.d.f.LabsDSSampleOpRefreshService : Updating sample op from lab inbox items group [803970-0 TURKEY BREAST, assigned-to=[{Yian Shooster, id=1234567}], org="NFFL", work-id=6487464]
Hibernate: select employee0_.id as id1_1_0_, labgroup1_.id as id1_4_1_, employee0_.facts_person_id as facts_person_id2_1_0_, employee0_.fda_email_account_name as fda_email_account_3_1_0_, employee0_.first_name as first_name4_1_0_, employee0_.lab_group_id as lab_group_id5_1_0_, employee0_.last_name as last_name6_1_0_, employee0_.middle_name as middle_name7_1_0_, employee0_.password as password8_1_0_, employee0_.short_name as short_name9_1_0_, labgroup1_.address_city as address_city2_4_1_, labgroup1_.address_state as address_state3_4_1_, labgroup1_.address_street as address_street4_4_1_, labgroup1_.address_zip as address_zip5_4_1_, labgroup1_.buildings_and_rooms as buildings_and_room6_4_1_, labgroup1_.description as description7_4_1_, labgroup1_.facts_org_name as facts_org_name8_4_1_, labgroup1_.facts_parent_org_name as facts_parent_org_n9_4_1_, labgroup1_.name as name10_4_1_ from employee employee0_ inner join lab_group labgroup1_ on employee0_.lab_group_id=labgroup1_.id where employee0_.facts_person_id=?
2018-10-01 15:26:00.055  WARN 11216 --- [ask-scheduler-1] g.f.n.a.d.f.LabsDSSampleOpRefreshService : Updated sample op [803970-0 "TURKEY BREAST", lab-group="ARL-MICRO1", parent-org="ARKL", work-id=6487464] is in lab group with parent organization "ARKL" which differs from that specified in the source lab inbox item [803970-0 TURKEY BREAST, assigned-to=[{Yian Shooster, id=1234567}], org="NFFL", work-id=6487464]. The lab group was found by the assigned employee #1234567.
Hibernate: select sampleopas0_.id as id1_7_, sampleopas0_.assigned_instant as assigned_instant2_7_, sampleopas0_.employee_id as employee_id3_7_, sampleopas0_.lead as lead4_7_, sampleopas0_.sample_op_id as sample_op_id5_7_ from sample_op_assignment sampleopas0_ where sampleopas0_.sample_op_id=?
Hibernate: select employee0_.id as id1_1_0_, labgroup1_.id as id1_4_1_, employee0_.facts_person_id as facts_person_id2_1_0_, employee0_.fda_email_account_name as fda_email_account_3_1_0_, employee0_.first_name as first_name4_1_0_, employee0_.lab_group_id as lab_group_id5_1_0_, employee0_.last_name as last_name6_1_0_, employee0_.middle_name as middle_name7_1_0_, employee0_.password as password8_1_0_, employee0_.short_name as short_name9_1_0_, labgroup1_.address_city as address_city2_4_1_, labgroup1_.address_state as address_state3_4_1_, labgroup1_.address_street as address_street4_4_1_, labgroup1_.address_zip as address_zip5_4_1_, labgroup1_.buildings_and_rooms as buildings_and_room6_4_1_, labgroup1_.description as description7_4_1_, labgroup1_.facts_org_name as facts_org_name8_4_1_, labgroup1_.facts_parent_org_name as facts_parent_org_n9_4_1_, labgroup1_.name as name10_4_1_ from employee employee0_ inner join lab_group labgroup1_ on employee0_.lab_group_id=labgroup1_.id where employee0_.facts_person_id=?
Hibernate: insert into sample_op_assignment (assigned_instant, employee_id, lead, sample_op_id) values (?, ?, ?, ?)
2018-10-01 15:26:00.117  WARN 11216 --- [ask-scheduler-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 1, SQLState: 23000
2018-10-01 15:26:00.117 ERROR 11216 --- [ask-scheduler-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : ORA-00001: unique constraint (LABELNG.UN_SMPOPAST_SMPIDEMPID) violated
2018-10-01 15:26:00.133  WARN 11216 --- [ask-scheduler-1] g.f.n.a.d.f.LabsDSSampleOpRefreshService : Failed to update sample op for lab inbox items group
  [803970-0 TURKEY BREAST, assigned-to=[{Yian Shooster, id=1234567}], org="NFFL", work-id=6487464]
  constraint [LABELNG.UN_SMPOPAST_SMPIDEMPID]


New Feature Soon for Demo
-------------------------
Allow searching for sample information for a given lot # of a reagent (media).


Work Done
---------
Pdf report
  Support any number of subs/composites results.
  Add audit log.
  Customize display of some fields, with red highlight for exceptional values.

Deployed to dev and test servers.
  Systemd installation, custom unpriv user, properties-file driven, logging etc.
  Removed Tomcat dependency.

Sample refresh from FACTS
  Syncing algorithm basically finished, needs final testing.
  Problem reporting to Oracle table as well as app logs.
  Samples assigned to unregistered employees are assigned to administrative lab group.


LABS-DS API Needs
-----------------
Need to know which fields might be null in lab inbox result objects.
Need a way of fetching all lab inbox results, why limit of 50 results? Scroll-token api?


Commit Notes
------------


------------


Implement "lab inbox" management over the api directly.
  Then sample/assignment data is always current during management ops which is necessary anyway.


Pushing data into FACTS
  Lower priority for now.


Spring Reverse Proxy Setup using Spring Cloud / Zuul
  https://spring.io/guides/tutorials/spring-security-and-angular-js/


Commit Notes
------------

------------


JWT Invalidation
----------------
  Make user cache safe for concurrent use, maybe replace.
  Add a mechanism to tell the server to flush the user cache (in UserContextManager) for a given user or all users.
  Add disabled field to employee and AppUser.
  Have jwt recognizer check whether the user is disabled.


Data Access
-----------
Decide whether to proceed with JPA.
  Try QueryDSL code generation from db.
    http://www.querydsl.com/static/querydsl/4.1.3/reference/html_single/#sql_integration
    Spring Integration: http://www.querydsl.com/static/querydsl/4.1.3/reference/html_single/#d0e1449
Try implementing dummy header-based security, using Spring security filter.
  Using IE, is any SSO header available at the server? No


# Example api calls

GET http://localhost:8080/alis/api/user/context
Accept: application/json
Cache-Control: no-cache

###
POST http://localhost:8080/alis/api/auth/password
Accept: application/json
Cache-Control: no-cache
Content-Type: application/x-www-form-urlencoded

username=SCH1&password=123

###


Vidas Data Retrieval
--------------------
QR Codes
  https://davidshimjs.github.io/qrcodejs/
    Standalone, lightweight, not sure about QR code sizes supported.
  https://demos.shieldui.com/web/qrcode/basic-usage
    Depends on jquery and shieldui, supports all sizes of QR codes.
    http://demos.shieldui.com/web/qrcode/api
  Version 40 bar code with 1276 bytes of data:
    https://softwareengineering.stackexchange.com/questions/251062/how-many-bytes-can-i-fit-into-a-qr-code-with-low-notice-correction

Make a grid of QR codes for input text data.
  Try inline block layout for the qr codes.
  Divide data into fixed size chunks, encode each.


Schema/Entities
---------------

FACTS Data
----------
FACTS_WORK_REQUESTS
  RQST_DATE
  STATUS_CODE
  PRSN_ID
FACTS_WORK
  ASSGNR_PRSN_ID
  ESTMTD_START_DATE
  RQSTR_TRGT_CMPLTN_DATE
  STATUS_CODE
  SMPL_TRCKNG_NUM
  PRSN_ID
|
-< FACTS_WORK_PACS
     PAC_CODE

FACTS_SAMPLE_TRACKING_NUMBERS
  SMPL_TRCKNG_NUM
  PRSN_ID

FACTS_SAMPLES
  SMPL_TRCKNG_NUM

FACTS_SAMP_PROD_PACS
  SAMP_PROD_ID
  SMPL_TRCKNG_NUM (num) [not required]
  PAC_CODE (alpha) [not required]

FACTS_SAMPLE_ANALYSES
  SMPL_ANLYS_ID
  SMPL_TRCKNG_NUM
  SMPL_TRCKNG_SUB_NUM
  PAC_CODE

FACTS_AS_MICROBIOLOGY
  ANLYS_MIC_ID
  SMPL_ANLYS_ID
  PRBLM_CODE
  MTHD_CODE
  MTHD_SRC_CODE
  SUBS_EXMND_NUM
  SUBS_USED_CMPST_NUM
  CMPSTS_EXMND_NUM
  SUBS_DTCT_FND_NUM
|
-< FACTS_AS_MIC_LMT_SAMP_PREP
 |
 -< FACTS_AS_LMT_FINDS
 |
 -< FACTS_AS_LMT_ADD_PREP
|
-< FACTS_AS_MIC_FINDS
 |
 -< FACTS_AS_MIC_IDS
|
-< FACTS_AS_MIC_KIT_TESTS
|
-< FACTS_AS_MIC_PRSV_CATEGORIES
 |
 -< FACTS_AS_MIC_PRSV_PREPS
  |
  -< FACTS_AS_MIC_PRSV_FINDS
   |
   -< FACTS_AS_MIC_PRSV_OBSRVTNS


FACTS_ANALYSIS_GRP1
  ANLYS_GRP1_ID
  SMPL_ANLYS_ID
  MTHD_CODE
  INSTRMT_CODE
  SUBS_EXMND_NUM
  SUBS_PSTV_NUM
  TEST_KIT_RSLT_CODE
FACTS_ANALYSIS_GRP1_FINDINGS
  ANLYS_GRP1_FNDNG_ID
  SUB_NUM_CODE
  ANLYS_GRP1_ID
  AMT_FND_NUM
  AMT_UNIT_CODE
  SPIKE_MTRL_CODE
  SPIKE_LVL_NUM
  SPIKE_UNIT_CODE


Questions
---------
Are jars and bags disposable or to be entered into database for display in dropdown lists?

For John:
  Is subs per comp always num comps / num subs (each sub assigned into exactly one composite)?
    extracted_grams_per_sub, num_subs, num_comps, comp_grams, num_subs_per_comp
    Need to capture deviations via note? Or capture count of subs within each component?
  Is it necessary to carry around pack code with the sample id everywhere?
    I've designed this way, but want to check that this is really necessary.




Hardware
--------
  laptops
  batching barcode scanners.
    https://www.zebra.com/us/en/support-downloads/mobile-computers/handheld/mc9090-wm.html

Security
--------
SAML for single sign on?

App ID: 0757



API Doc
-------
Maybe generate api doc via https://www.vojtechruzicka.com/documenting-spring-boot-rest-api-swagger-springfox/


Leidos API Swagger Docs
  LabsDataService/swagger-ui.html


EPLC
----
Security doc required: System Security Plan (SSP), Risk Assessment, and Authorization to Operate (ATO)

Oracle 12.2 Availability:
  https://blogs.oracle.com/upgrade/oracle-database-12201-on-premises-is-now-available%2c-too
