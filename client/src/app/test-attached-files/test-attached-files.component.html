<div class="sample-in-test-information">
   <app-sample [sample]="sampleInTest.sample"></app-sample>
   <div class="test-type">{{sampleInTest.testMetadata.testTypeShortName}}</div>
</div>

<div class="content-stack">

   <div class="table-container mat-elevation-z8" *ngIf="attachedFilesTableDataSource.data.length > 0; else noFiles">

      <table mat-table [dataSource]="attachedFilesTableDataSource">

         <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Attached File</th>
            <td mat-cell *matCellDef="let af">
               <button class="link" (click)="promptDownloadFile(af)">{{af.fileName}}</button>
            </td>
         </ng-container>

         <ng-container matColumnDef="role">
            <th mat-header-cell *matHeaderCellDef>Role</th>
            <td mat-cell *matCellDef="let af">
               {{af.role}}
            </td>
         </ng-container>

         <ng-container matColumnDef="uploaded">
            <th mat-header-cell *matHeaderCellDef>Uploaded</th>
            <td mat-cell *matCellDef="let af">
               {{af.uploadedInstant | date: 'MMM d h:mm a'}}
            </td>
         </ng-container>

         <ng-container matColumnDef="size">
            <th mat-header-cell *matHeaderCellDef>Size</th>
            <td mat-cell *matCellDef="let af">
               {{af.size/1000 | number: '1.0-0'}} KB
            </td>
         </ng-container>

         <ng-container matColumnDef="delete">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let af">
               <button mat-icon-button (click)="removeAttachedFile(af)"><mat-icon>delete_forever</mat-icon></button>
            </td>
         </ng-container>

         <tr mat-header-row *matHeaderRowDef="attachedFilesDisplayColumns"></tr>
         <tr mat-row *matRowDef="let row; columns: attachedFilesDisplayColumns"></tr>

      </table>

      <mat-paginator
         #resultSetsPaginator
         [pageSize]="25"
         [pageSizeOptions]="[25, 50, 100, 1000]"
         [showFirstLastButtons]="true">
      </mat-paginator>

   </div> <!-- table container -->

   <ng-template #noFiles>
      <div class="no-files-message"><span>No files attached.</span></div>
   </ng-template>

   <div class="new-attachments-area" *ngIf="modificationsEnabled">

      <form [formGroup]="newAttachmentsForm" (submit)="submitNewAttachments()">

         <button type="submit" mat-raised-button color="primary"
                 [disabled]="newAttachmentsForm.invalid || filesSelector.selectedFiles.length === 0">
            Attach the below files
         </button>

         <span>with role</span>

         <mat-form-field>
            <input matInput placeholder="enter role (optional)" formControlName="role">
         </mat-form-field>

      </form>

      <app-files-selector class="files-selector" #filesSelector></app-files-selector>

   </div>

</div>
